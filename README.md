![](https://img.shields.io/badge/license-CC%20BY--NC%204.0-green?style=for-the-badge)

# Online repository

### Description

Online repository to reproduce the results presented in :

Prey movement shapes the acquisition of predator expertise in a virtual bi-trophic system. (2024). *BioRxiv*. https://doi.org/10.1101/2024.11.15.621573

---
### Reproducibility

#### Preparing the project

1. Clone the repository using `git clone https://github.com/quantitative-ecologist/predator-expertise.git`
2. Install [`renv`](https://rstudio.github.io/renv/)
3. In the root folder, open R and run `renv::restore()`, this will install all the packages with proper versions from the `renv.lock` file
4. Download the model outputs by following the steps described below

** Note for Windows users: refrain from putting the project inside OneDrive as it struggles with renv. Just put the project in a place that is not tracked by OneDrive. **


#### Download the model outputs

The model fitting cannot be reproduced on your personal computer as it requires important computing resources. The model output files (`.rds`) are hosted in this [OSF repository](https://osf.io/hdv38/).

To download the files locally: 
- Open a terminal
- Go to the root folder of the project
- Type `make download-models` in your terminal
- This will create a subfolder within [outputs](./outputs) called `outputs_models` and download all the model output files in it

---
### General coding workflow

The subfolders in the [code folder](./code) are ordered to reflect the worflow. 

Here are the steps highlighting the process with a link to the code subfolders :

1. [Run models](./code/code_models) --> **Not needed, see 'Reproducibility' section above**
2. [Model validation](./code/code_model-validation)
3. [Model processing](./code/code_model-processing)
4. [Produce figures](./code/code_figures)

You will find the specific outputs generated by the R scripts in the [outputs](./outputs) folder.

---
### Workflow to run the models

This workflow is exclusively for `.R` files used to compute the Bayesian `GAMM`s with the `brms` package (see the [code_models](./code/code_models) folder). The `fit_LM-PreySpeed.R` model does not require important resources and was run locally.

| Generator              | Operating system | Programming language | Code               | Results                  |
| ---------------------- | ---------------- | -------------------- | ------------------ | ------------------------ |
| Digital Research Alliance of Canada / Cedar | CentOS Linux 7   | R                    | [code_models](./code/code_models/) folder | [outputs_models](./outputs) folder** |

- I ran all the `GAMM` models on [Cedar](https://docs.alliancecan.ca/wiki/Cedar), a computer cluster managed by the [Digital Research Alliance of Canada](https://www.alliancecan.ca/en). 

- To run the models on a cluster other than Cedar, simply use the job (`.sh`) files and adapt them to your needs. They are in the [code_models](./code/code_models) folders and have the same name as the `.R` model files.

- ** Note that **the `outputs_models` folder has to be created if you want to transfer the files there and continue working with the project (i.e., produce figures, etc.).**
